<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Self-Cross Diffusion Guidance for Text-to-Image Synthesis of Similar Subjects.">
  <meta name="keywords" content="Diffusion, Text-to-Image, Guidance">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Self-Cross Diffusion Guidance for Text-to-Image Synthesis of Similar Subjects</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <style>
    .center-img {
        display: block;
        margin: auto;
    }
  </style>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Self-Cross Diffusion Guidance for Text-to-Image Synthesis of Similar Subjects</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://qiuweimin1332499.github.io/qiuweimin.github.io/">Weimin Qiu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://jackywang2001.github.io/">Jieke Wang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="http://www.mengtang.org">Meng Tang</a><sup>1</sup>,</span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of California, Merced</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://openaccess.thecvf.com/content/CVPR2025/html/Qiu_Self-Cross_Diffusion_Guidance_for_Text-to-Image_Synthesis_of_Similar_Subjects_CVPR_2025_paper.html"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2411.18936"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/mengtang-lab/selfcross-guidance"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/mengtang-lab/selfcross-guidance/blob/main/prompts.txt"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Similar Subjects Dataset</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Subject mixing is a known and unresolved issue for diffusion-based image synthesis, particularly for
            synthesizing multiple similar-looking subjects. We propose Self-Cross Diffusion Guidance to penalize
            the overlap between cross-attention maps and aggregated self-attention maps. Compared to previous methods
            based on self-attention or cross-attention alone, our guidance is more effective in eliminating subject
            mixing.
          </p>
          <p>
            What’s more, our guidance addresses mixing for all relevant patches of a subject beyond the most
            discriminant one, e.g., the beak of a bird. We aggregate self-attention maps of automatically selected
            patches for a subject to form a region that the whole subject attends to.
          </p>
          <p>
            Our guidance is training-free
            and can boost the performance of both Unet-based and transformer-based diffusion models such as the Stable
            Diffusion series. We also release a more challenging benchmark with prompts of similar-looking subjects
            and utilize GPT-4o for automatic and reliable evaluation. Extensive qualitative and quantitative results
            demonstrate the effectiveness of our Self-Cross Diffusion Guidance.
          </p>
          <p>
            For example “a bear and an elephant”. the image below describes the aggregation of self-attention maps.
              Given the cross-attention map of “bear”, we select patches with high responses and visualize their
              self-attention maps. With our assumption that, at some time steps and layers, a subject should not
              attend to other subjects in the image, we propose to penalize the overlap between the aggregated
              self-attention map and cross-attention maps of other subjects.
          </p>
          <p>
              <img src="static/images-for-githubio/attentionmaps.png" class="center-img" width="600" height="600" alt="Sample Image">
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <!-- Visual Effects. -->
        <div class="content">
          <h2 class="title is-3">Qualitative comparisons</h2>
          <p>
            Qualitative comparisons between original SD3-medium and our method.
              Notice that in SD3 we can use image-text attention maps instead of cross-attention maps and use image-image attention maps instead of self-attention maps.
          </p>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a bear riding an elephant with a rabbit</th>
            </tr>
            <tr>
                <th>SD3</th>
                <td><img src="static/images-for-githubio/original/a bear riding an elephant with a rabbit/311832740.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear riding an elephant with a rabbit/944355760.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear riding an elephant with a rabbit/1157314996.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear riding an elephant with a rabbit/1334603401.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/ours/a bear riding an elephant with a rabbit/311832740.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear riding an elephant with a rabbit/944355760.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear riding an elephant with a rabbit/1157314996.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear riding an elephant with a rabbit/1334603401.png"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a beagle and a collie and a husky</th>
            </tr>
            <tr>
                <th>SD3</th>
                <td><img src="static/images-for-githubio/original/a beagle and a collie and a husky/274254909.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a beagle and a collie and a husky/427291101.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a beagle and a collie and a husky/709115539.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a beagle and a collie and a husky/2024290418.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/ours/a beagle and a collie and a husky/274254909.png"></td>
                <td><img src="static/images-for-githubio/ours/a beagle and a collie and a husky/427291101.png"></td>
                <td><img src="static/images-for-githubio/ours/a beagle and a collie and a husky/709115539.png"></td>
                <td><img src="static/images-for-githubio/ours/a beagle and a collie and a husky/2024290418.png"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a bear and a wolf and a fox</th>
            </tr>
            <tr>
                <th>SD3</th>
                <td><img src="static/images-for-githubio/original/a bear and a wolf and a fox/427291101.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear and a wolf and a fox/472948517.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear and a wolf and a fox/1238636055.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a bear and a wolf and a fox/1723679130.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/ours/a bear and a wolf and a fox/427291101.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear and a wolf and a fox/472948517.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear and a wolf and a fox/1238636055.png"></td>
                <td><img src="static/images-for-githubio/ours/a bear and a wolf and a fox/1723679130.png"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a eagle and a owl and a seagull</th>
            </tr>
            <tr>
                <th>SD3</th>
                <td><img src="static/images-for-githubio/original/a eagle and a owl and a seagull/2097637880.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a eagle and a owl and a seagull/289812547.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a eagle and a owl and a seagull/1690782657.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a eagle and a owl and a seagull/1923433937.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/ours/a eagle and a owl and a seagull/2097637880.png"></td>
                <td><img src="static/images-for-githubio/ours/a eagle and a owl and a seagull/289812547.png"></td>
                <td><img src="static/images-for-githubio/ours/a eagle and a owl and a seagull/1690782657.png"></td>
                <td><img src="static/images-for-githubio/ours/a eagle and a owl and a seagull/1923433937.png"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a parrot and a pigeon and a sparrow</th>
            </tr>
            <tr>
                <th>SD3</th>
                <td><img src="static/images-for-githubio/original/a parrot and a pigeon and a sparrow/1643267547.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a parrot and a pigeon and a sparrow/41535079.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a parrot and a pigeon and a sparrow/1690782657.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/original/a parrot and a pigeon and a sparrow/1278355521.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/ours/a parrot and a pigeon and a sparrow/1643267547.png"></td>
                <td><img src="static/images-for-githubio/ours/a parrot and a pigeon and a sparrow/41535079.png"></td>
                <td><img src="static/images-for-githubio/ours/a parrot and a pigeon and a sparrow/1690782657.png"></td>
                <td><img src="static/images-for-githubio/ours/a parrot and a pigeon and a sparrow/1278355521.png"></td>
            </tr>
          </table>

          <p>
            Qualitative comparisons between original SD2.1 and our method.
          </p>
          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a bear and a horse</th>
            </tr>
            <tr>
                <th>SD2</th>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a horse/1157952081.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a horse/2024290418.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a horse/2090184951.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a horse/2113536712.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a horse/1157952081.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a horse/2024290418.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a horse/2090184951.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a horse/2113536712.png" alt="Alice"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a bear and a rabbit</th>
            </tr>
            <tr>
                <th>SD2</th>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a rabbit/709115539.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a rabbit/771886858.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a rabbit/944355760.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a bear and a rabbit/2024290418.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a rabbit/709115539.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a rabbit/771886858.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a rabbit/944355760.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a bear and a rabbit/2024290418.png" alt="Alice"></td>
            </tr>
          </table>

          <table>
            <tr>
                <th>prompt</th>
                <th colspan="4">a lion and a monkey</th>
            </tr>
            <tr>
                <th>SD2</th>
                <td><img src="static/images-for-githubio/sd2/original/a lion and a monkey/16301755.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a lion and a monkey/41535079.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a lion and a monkey/1476362273.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/original/a lion and a monkey/2024290418.png" alt="Alice"></td>
            </tr>
            <tr>
                <th>Ours</th>
                <td><img src="static/images-for-githubio/sd2/ours/a lion and a monkey/16301755.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a lion and a monkey/41535079.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a lion and a monkey/1476362273.png" alt="Alice"></td>
                <td><img src="static/images-for-githubio/sd2/ours/a lion and a monkey/2024290418.png" alt="Alice"></td>
            </tr>
          </table>
        </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <!-- Visual Effects. -->
        <div class="content">
          <h2 class="title is-3">Quantitative comparisons</h2>

          <p>
            Quantitative comparisons between original SD1.4,SD2.1,SD3-medium and our method.
          </p>
          <table>
            <tr>
                <th>methods</th>
                <th colspan="4">Similar Subjects Dataset-3 (21 prompts)</th>
            </tr>
            <tr>
                <th>Question Types</th>
                <td>Existence</td>
                <td>Recognizability</td>
                <td>with out Mixture</td>
                <td>text-to-text similarity</td>
            </tr>
            <tr>
                <th>SD3</th>
                <td>33.54</td>
                <td>30.31</td>
                <td>70.08 </td>
                <td>73.82</td>
            </tr>
            <tr>
                <th>Ours</th>
                <td>57.92</td>
                <td>53.08</td>
                <td>77.15</td>
                <td>74.96</td>
            </tr>
          </table>

          <table>
            <tr>
                <th>methods</th>
                <th colspan="4">Animal-Animal (66 prompts)</th>
            </tr>
            <tr>
                <th>Question Types</th>
                <td>Existence</td>
                <td>Recognizability</td>
                <td>with out Mixture</td>
                <td>text-to-text similarity</td>
            </tr>
            <tr>
                <th>SD2</th>
                <td>61.63</td>
                <td>38.23</td>
                <td>67.51</td>
                <td>81.68</td>
            </tr>
            <tr>
                <th>Ours</th>
                <td>89.53</td>
                <td>55.03</td>
                <td>78.79</td>
                <td>84.02</td>
            </tr>
          </table>

          <table>
            <tr>
                <th>methods</th>
                <th colspan="4">Animal-Animal (66 prompts)</th>
            </tr>
            <tr>
                <th>Question Types</th>
                <td>Existence</td>
                <td>Recognizability</td>
                <td>with out Mixture</td>
                <td>text-to-text similarity</td>
            </tr>
            <tr>
                <th>SD1</th>
                <td>39.51</td>
                <td>29.70</td>
                <td>72.24</td>
                <td>76.50</td>
            </tr>
            <tr>
                <th>Ours</th>
                <td>94.55</td>
                <td>87.79</td>
                <td>92.94</td>
                <td>84.30</td>
            </tr>
          </table>
        </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Related Work. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Related Links</h2>

        <div class="content has-text-justified">
          <p>
            There's a lot of excellent work on this topic.
          </p>
          <p>
            <a href="https://conform-diffusion.github.io/">CONFORM: Contrast is All You Need For High-Fidelity Text-to-Image Diffusion Models</a>
            introduces a contrastive loss between cross attention maps.
          </p>
          <p>
            <a href="https://xiefan-guo.github.io/initno/">InitNO: Boosting Text-to-Image Diffusion Models via Initial Noise Optimization</a>
            use self attention maps to optimize the beginning few steps during inference.
          </p>
          <p>
            Some works focus on the existence of subjects, such as <a href="https://yuval-alaluf.github.io/Attend-and-Excite/">Attend-and-Excite:
            Attention-Based Semantic Guidance for Text-to-Image Diffusion Models</a>
          </p>
          <p>
            There are probably many more by the time you are reading this. For example <a href="https://arxiv.org/abs/2411.18301">Enhancing MMDiT-Based Text-to-Image Models for Similar Subject Generation</a>.
          </p>
        </div>
      </div>
    </div>
    <!--/ Related Work. -->
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{2025selfcross,
  author    = {Weimin, Qiu and Jieke, Wang and Meng, Tang},
  title     = {Self-Cross Diffusion Guidance for Text-to-Image Synthesis of Similar Subjects},
  booktitle   = {CVPR},
  year      = {2025},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This website's source code is borrowed from the  <a
              href="https://github.com/nerfies/nerfies.github.io">Nerfies</a> project page.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
